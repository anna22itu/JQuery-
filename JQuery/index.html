<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"> </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function(){
            $("#p2").hide();
            $("#div1").hide();
            $("#tablaTest").hide();


            $("#btn1").click(function(){
                var user = $("#test").val()
                alert("Username: " + user);
                $.get("https://api.github.com/users/"+user+"/repos", function(data, status) {
                    alert("Data: " + JSON.stringify(data) + "\nStatus: " + status);

                    $("#btn2").click(function(){
                        //location.replace("https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js")
                        const arrId = [];
                        const arrName = [];
                        const arrDes = [];
                        const arrFoll = [];
                        const arrSize = [];
                        const arrLang = [];

                        /**
                         * JSON.stringify(data) ponerlo solo cuando tus datos son vectores o objetos
                         * JSON.parse es lo contrario que JSON.stringify()
                         *
                         * 1. redirect -- cambiar de pagina
                         * 2. que vaya a la pagina o que le pases un parametre de la url resultat.html? nombre:
                         */
                        for (var i=0; i<data.length;i++){
                            var id = data[i].id;
                            var name = data[i].name;
                            var description = data[i].description;
                            var followers = data[i].stargazers_count;
                            var size = data[i].size;
                            var language = data[i].language;

                            arrId.push(id);
                            arrName.push(name);
                            arrDes.push(description);
                            arrFoll.push(followers);
                            arrSize.push(size);
                            arrLang.push(language);

                            console.log(arrId);
                            console.log(arrName);
                            console.log(arrDes);
                            console.log(arrFoll);
                            console.log(arrSize);
                            console.log(arrLang);

                            if (i===data.length-1){
                                $("#p2").show();
                                $("#tablaTest").show();


                                for (var j=0; j<data.length;j++) {
                                    // añadir el que borro
                                    var row = "<tr><td>" + arrId[j] + "</td><td>" + arrName[j] + "</td><td>" + arrDes[j] + "</td><td>" + arrFoll[j] + "</td><td>" + arrSize[j] + "</td><td>" + arrLang[j] + "</td></tr>";
                                    $(".table tbody").append(row);
                                }
                            }
                        }
                    });
                });
            });
        });

    </script>
</head>
<body>

    <div id = "id" style="text-align:center">
        <h1>JQuery & Bootstrap</h1>
        <br>
        <p id ="p1" >Enter your username: <input type="text" id="test" value=""></p>
        <button id="btn1">Save username</button>
        <button id="btn2">Print all information</button>
        <div id = "div1">elementos ocultos</div>
        <br>
        <br>
        <p id ="p2" style="text-align:center" class="text-success">Los datos se han cargado correctamente</p>
        <br>
        <br>
    </div>

    <div class="container fluid" id="tablaTest" style="text-align:center">
        <h2>Tabla de información</h2>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Followers</th>
                    <th>Size</th>
                    <th>Language</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

</body>
</html>
